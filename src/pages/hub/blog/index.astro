---
import HubLayout from '../../../layouts/HubLayout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<HubLayout title="TIL & Blog Log">
  <div class="tools-bar">
    <a href="/hub/blog/new" class="text-mono text-small">[+ 기록 작성]</a>
  </div>

  <div class="log-list">
    {sortedPosts.map(post => (
      <article class="log-entry">
        <header class="entry-header">
          <time class="text-mono">{post.data.date.toISOString().split('T')[0]}</time>
          <h2 class="entry-title"><a href={`/hub/blog/${post.slug}`}>{post.data.title}</a></h2>
        </header>
        <p class="summary">{post.data.summary}</p>
        {post.data.tags && (
          <div class="tags text-mono text-small">
            tags: {post.data.tags.join(', ')}
          </div>
        )}
      </article>
    ))}
  </div>
</HubLayout>

<style>
  .tools-bar { 
    text-align: right; 
    margin-bottom: 2rem; 
    border-bottom: 1px dotted var(--c-border);
    padding-bottom: 0.5rem;
  }

  .log-entry {
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--c-border);
  }
  .log-entry:last-child { border-bottom: none; }

  .entry-header {
    margin-bottom: 0.5rem;
  }
  .entry-header time {
    font-size: 0.85rem;
    color: var(--c-ink-light);
    display: block;
    margin-bottom: 0.25rem;
  }
  .entry-title {
    margin: 0;
    font-size: 1.4rem;
    border: none;
    padding: 0;
  }
  .entry-title a { color: var(--c-ink); }
  .entry-title a:hover { color: var(--c-blue); text-decoration: underline; }

  .summary { margin-bottom: 0.5rem; }
  .tags { color: var(--c-teal); }
</style>
